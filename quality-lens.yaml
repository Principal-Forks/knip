# Quality Lens Configuration for knip
# Uses Biome for linting and formatting
# Updated: trigger CI with latest CLI 0.1.88 (coverage.files support)

lenses:
  # Linting with Biome
  biome-lint: pnpm exec biome lint . --reporter=json

  # Formatting with Biome
  biome-format: pnpm exec biome format . --reporter=json

  # Type checking (--listFiles needed for complete file metrics)
  typescript: pnpm exec --dir packages/knip tsc --noEmit --listFiles

  # Dead code analysis (knip on itself)
  knip: pnpm exec --dir packages/knip knip --directory ../.. --reporter json

  # Node.js native test runner with coverage (root only - tests are centralized)
  # Use --test-reporter spec to ensure coverage output is parseable
  node-test:
    command: "pnpm exec tsx --test --test-reporter spec --experimental-test-coverage test/*.test.ts test/**/*.test.ts"
    cwd: packages/knip
    scope: root

# Exclude build outputs, docs, and test fixtures
exclude:
  - "**/dist/**"
  - "**/tmp/**"
  - "packages/docs/.astro/**"
  - "packages/docs/**"
  - "packages/knip/fixtures/**"
  - "packages/knip/test/**"
  - "templates/**"
  - "**/node_modules/**"
